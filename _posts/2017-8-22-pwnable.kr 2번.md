---
title: pwnable.kr 2번 Write-up
date: 2017-8-22 11:37:00
categories: pwnable.kr
tags: pwnable.kr, collision
---

## pwnable.kr 2번 - collision

    col@ubuntu:~$ ls
    col  col.c  flag
    col@ubuntu:~$ cat col.c
    #include <stdio.h>
    #include <string.h>
    unsigned long hashcode = 0x21DD09EC;
    unsigned long check_password(const char* p){
            int* ip = (int*)p;
            int i;
            int res=0;
            for(i=0; i<5; i++){
                    res += ip[i];
            }
            return res;
    }
    
    int main(int argc, char* argv[]){
            if(argc<2){
                    printf("usage : %s [passcode]\n", argv[0]);
                    return 0;
            }
            if(strlen(argv[1]) != 20){
                    printf("passcode length should be 20 bytes\n");
                    return 0;
            }
    
            if(hashcode == check_password( argv[1] )){
                    system("/bin/cat flag");
                    return 0;
            }
            else
                    printf("wrong passcode.\n");
            return 0;
    }

이번에는 뭔가 소스가 길다.

    col@ubuntu:~$ ./col
    usage : ./col [passcode]
    col@ubuntu:~$ ./col 1234
    passcode length should be 20 bytes
    col@ubuntu:~$ ./col 12345678901234567890
    wrong passcode.

똑같이 인자를 전달받는데, 길이는 20바이트로 정해져 있으며, 문자열이 일치할 경우에만 플래그를 출력해 준다.