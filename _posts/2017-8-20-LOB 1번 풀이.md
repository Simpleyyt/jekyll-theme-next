---
title: LOB 1번 Write-up
categories: LOB
---

# LOB 1번


LOB를 설치한 VM의 주소로 접속하면 이러한 화면이 나옵니다.
~~~
_______________________
  _______________________-------------------                       `\
 /:--__                                                              |
||< > |                                   ___________________________/
| \__/_________________-------------------                         |
|                                                                  |
 |        The Lord of the BOF : The Fellowship of the BOF, 2010    |
 |                                                                  |
 |                                                                  |
  |       [enter to the dungeon]                                    |
  |       gate : gate                                                |
  |                                                                  |
  |       [RULE]                                                     |
   |      - do not use local root exploit                             |
   |      - do not use LD_PRELOAD to my-pass                          |
   |      - do not use single boot                    [h4ck3rsch001] |
  |                                              ____________________|_
  |  ___________________-------------------------                      `\
  |/`--_                                                                 |
  ||[ ]||                                            ___________________/
   \===/___________________--------------------------

login:
~~~
LOB에서는 my-pass 명령을 쳤을 때 다음 레벨의 비밀번호인 플래그가 출력되는데, 아직은 gate권한을 가지고 있으므로 이렇게 플래그 출력을 거부합니다.
~~~
[gate@localhost gate]$ id
uid=500(gate) gid=500(gate) groups=500(gate)
[gate@localhost gate]$ my-pass
euid = 500
I dunno
~~~
현재 디렉토리에는 파일이 3개가 있습니다.
~~~
[gate@localhost gate]$ ls -l
total 16
-rwsr-sr-x    1 gremlin  gremlin     11987 Feb 26  2010 gremlin
-rw-rw-r--    1 gate     gate          272 Mar 29  2010 gremlin.c
~~~
Bash2를 띄운 후 gremlin의 소스를 확인하면 이렇게 생겼습니다.
~~~
[gate@localhost gate]$ bash2
[gate@localhost gate]$ cat gremlin.c
/*
        The Lord of the BOF : The Fellowship of the BOF
        - gremlin
        - simple BOF
*/

int main(int argc, char *argv[])
{
    char buffer[256];
    if(argc < 2){
        printf("argv error\n");
        exit(0);
    }
    strcpy(buffer, argv[1]);
    printf("%s\n", buffer);
}
~~~
간단한 BOF라네요.
argc인자로 값을 받아오는 구조이고, 256바이트의 버퍼에 저장합니다.
오버플로우가 생길거라고 말해줍니다.

gremlin 실행파일의 소유자 변경을 위해 하나 복사해주었습니다.
~~~
[gate@localhost gate]$ cp gremlin gremlin1
[gate@localhost gate]$ ls -l
total 28
-rwsr-sr-x    1 gremlin  gremlin     11987 Feb 26  2010 gremlin
-rw-rw-r--    1 gate     gate          272 Mar 29  2010 gremlin.c
-rwsr-sr-x    1 gate     gate        11987 Aug 20 12:45 gremlin1
~~~
메모리에는 256바이트의 버퍼값과 4바이트의 버퍼 주소값이 저장되기 때문에 이처럼 파이썬 코드를 이용해 260바이트의 값을 넣어주면 Segmentation Fault가 출력됨을 알 수 있습니다.
Segmentation fault에러는 할당된 메모리를 넘어서서 잘못된 부분까지 건드릴 때 나오는 에러입니다. 오버플로우의 확인 메시지로 보면 됩니다.
~~~
[gate@localhost gate]$ ./gremlin1 `python -c 'print "a"*260'`
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Segmentation fault (core dumped)
~~~
리눅스의 사용자 권한은 realuid와 effectiveuid로 나눌 수 있습니다.
Realuid는 사용자의 진짜 권한이고, effectiveuid는 사용자에게 현재 임시로 할당된 권한까지 포함된 권한입니다.