---
title: LOB 3번 Write-up
date: 2017-9-3 15:42:00
categories: LOB
tags: LOB, cobolt, goblin
---

## LOB 3번

이번 레벨은 cobolt이다. 비밀번호는 hacking exposed이다.

    [cobolt@localhost cobolt]$ ls -l
    total 16
    -rwsr-sr-x    1 goblin   goblin      11824 Feb 26  2010 goblin
    -rw-r--r--    1 root     root          193 Mar 29  2010 goblin.c
    [cobolt@localhost cobolt]$ cat goblin.c
    /*
            The Lord of the BOF : The Fellowship of the BOF
            - goblin
            - small buffer + stdin
    */
    
    int main()
    {
        char buffer[16];
        gets(buffer);
        printf("%s\n", buffer);
    }

참고를 위해 LOB 2번 문제인 cobolt의 소스도 아래에 올려두었다.

    [gremlin@localhost gremlin]$ cat cobolt.c
    int main(int argc, char *argv[])
    {
        char buffer[16];
        if(argc < 2){
            printf("argv error\n");
            exit(0);
        }
        strcpy(buffer, argv[1]);
        printf("%s\n", buffer);
    }

### 입력방식의 차이

두 프로그램은 문자열을 받아오는 방식에 있어서 서로 다르다. 이전의 문제에서는 `strcpy`를 통해 문자열을 받아왔으나, 이번 문제에서는 프로그램 실행 후 `gets()`를 통해 문자열을 받아오는 것이다. 아래의 경우를 보며 확인해보자.

    [cobolt@localhost cobolt]$ ./goblin `python -c 'print"a"*21'`
    hello
    hello

이처럼 python으로 전달한 값은 무시되고 직접 hello를 입력한 값만 받아온다.

    (python -c 'print "a"*1')|(cat;./goblin)

참고로 메모리구조는 이전과 같다.

buffer(16byte)	|	SFP(4byte)	|	RET(4byte)