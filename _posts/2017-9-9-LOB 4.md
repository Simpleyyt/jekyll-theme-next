---
title: LOB 3번 Write-up
date: 2017-9-3 15:42:00
categories: LOB
tags: LOB, cobolt, goblin
---

## LOB 3번

[goblin@localhost goblin]$ ls
orc  orc.c
[goblin@localhost goblin]$ cat orc.c
/*
        The Lord of the BOF : The Fellowship of the BOF
        - orc
        - egghunter
*/

#include <stdio.h>
#include <stdlib.h>

    extern char **environ;
    
    main(int argc, char *argv[])
    {
            char buffer[40];
            int i;
    
            if(argc < 2){
                    printf("argv error\n");
                    exit(0);
            }
    
            // egghunter
            for(i=0; environ[i]; i++)
                    memset(environ[i], 0, strlen(environ[i]));
    
            if(argv[1][47] != '\xbf')
            {
                    printf("stack is still your friend.\n");
                    exit(0);
            }
    
            strcpy(buffer, argv[1]);
            printf("%s\n", buffer);
    }

이제 소스가 슬슬 이상해진다.