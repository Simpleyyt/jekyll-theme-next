---
title: pwnable.kr 1번 Write-up
date: 2017-8-22 11:19:00
categories: pwnable.kr
tags: pwnable.kr, fd
---

## pwnable.kr 1번 - fd

     ____  __    __  ____    ____  ____   _        ___      __  _  ____
    |    \|  |__|  ||    \  /    ||    \ | |      /  _]    |  |/ ]|    \
    |  o  )  |  |  ||  _  ||  o  ||  o  )| |     /  [_     |  ' / |  D  )
    |   _/|  |  |  ||  |  ||     ||     || |___ |    _]    |    \ |    /
    |  |  |  `  '  ||  |  ||  _  ||  O  ||     ||   [_  __ |     \|    \
    |  |   \      / |  |  ||  |  ||     ||     ||     ||  ||  .  ||  .  \
    |__|    \_/\_/  |__|__||__|__||_____||_____||_____||__||__|\_||__|\_|
    
    - Site admin : daehee87.kr@gmail.com
    - IRC : irc.netgarage.org:6667 / #pwnable.kr
    - Simply type "irssi" command to join IRC now
    - files under /tmp can be erased anytime. make your directory under /tmp
    - to use peda, issue `source /usr/share/peda/peda.py` in gdb terminal
    Last login: Mon Aug 21 19:10:19 2017 from 108.6.200.234

접속하면 이렇게 생긴 텍스트아트가 반겨준다.

    fd@ubuntu:~$ ls
    fd  fd.c  flag
    fd@ubuntu:~$ cat flag
    cat: flag: Permission denied
    fd@ubuntu:~$ ./fd 5
    learn about Linux file IO

위의 경우 처럼 잘못된 인자를 넘겨주면 리눅스 파일 입출력에 배우고 오라는 문구만 출력한다.

    fd@ubuntu:~$ cat fd.c
    #include <stdio.h>
    #include <stdlib.h>
    #include <string.h> char buf[32]; int main(int argc, char* argv[], char* envp[]){
            if(argc<2){
                    printf("pass argv[1] a number\n");
                    return 0;
            }
            int fd = atoi( argv[1] ) - 0x1234;
            int len = 0;
            len = read(fd, buf, 32);
            if(!strcmp("LETMEWIN\n", buf)){
                    printf("good job :)\n");
                    system("/bin/cat flag");
                    exit(0);
            }
            printf("learn about Linux file IO\n");
            return 0;
    
    }

fd.c를 보니 리눅스 파일 디스크립터와 관련된 문제임을 알 수 있다. fd는 파일 디스크립터의 약자이다. 위 소스에서 전달받은 값이 2 미만일 경우 에러를 출력하는데 이는 0, 1, 2는 이미 예약되어있기 때문이다. 
만약 fd가 0x1234, 즉 10진수로 4660과 다음 단계로 넘어간다.

이후에는 `read`함수로 최대 32바이트까지 문자열을 불러들이고, 불러들인 문자열이 LETMEWIN과 일치하면 `flag`를 출력해준다.

    fd@ubuntu:~$ ./fd 4660
    LETMEWIN
    good job :)
    mommy! I think I know what a file descriptor is!!

마지막줄이 플래그이다.